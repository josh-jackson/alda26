<!DOCTYPE html>
<html lang="en"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.450">

  <title>Longitudinal 2026 - MLM</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto.css">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">MLM</h1>

<div class="quarto-title-authors">
</div>

</section>
<section class="slide level2">

<p>How do we model our repeated measures?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">lm</span>(change_score <span class="sc">~</span> group, <span class="at">data =</span> df) <span class="co"># difference score</span></span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">lm</span>(t2 <span class="sc">~</span> t1 <span class="sc">+</span> group, <span class="at">data =</span> df) <span class="co"># residualized change</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Equivalent if assumed everyone starts the same. But does not easily scale to more than 2 occasions, among other pitfalls</p>
</section>
<section class="slide level2">


<img data-src="chelsea.jpeg" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="fu">set.seed</span>(<span class="dv">555</span>) </span>
<span id="cb2-5"><a href="#cb2-5"></a>n <span class="ot">&lt;-</span> <span class="dv">500</span>    </span>
<span id="cb2-6"><a href="#cb2-6"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-7"><a href="#cb2-7"></a>  <span class="at">group =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"Control"</span>, n), <span class="fu">rep</span>(<span class="st">"Tx"</span>, n)),</span>
<span id="cb2-8"><a href="#cb2-8"></a>  <span class="at">t1 =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">90</span>, <span class="at">sd =</span> <span class="dv">10</span>), <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">10</span>))</span>
<span id="cb2-9"><a href="#cb2-9"></a>)</span>
<span id="cb2-10"><a href="#cb2-10"></a></span>
<span id="cb2-11"><a href="#cb2-11"></a>df<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df<span class="sc">$</span>group)</span>
<span id="cb2-12"><a href="#cb2-12"></a>df<span class="sc">$</span>t2 <span class="ot">&lt;-</span> <span class="dv">20</span> <span class="sc">+</span> (<span class="fl">0.8</span> <span class="sc">*</span> df<span class="sc">$</span>t1) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">2</span><span class="sc">*</span>n, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">5</span>)</span>
<span id="cb2-13"><a href="#cb2-13"></a></span>
<span id="cb2-14"><a href="#cb2-14"></a>df_long <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb2-15"><a href="#cb2-15"></a>  <span class="fu">mutate</span>(df, <span class="at">id =</span> <span class="fu">row_number</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb2-16"><a href="#cb2-16"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb2-17"><a href="#cb2-17"></a>    <span class="at">cols =</span> <span class="fu">c</span>(t1, t2),   </span>
<span id="cb2-18"><a href="#cb2-18"></a>    <span class="at">names_to =</span> <span class="st">"wave"</span>,  </span>
<span id="cb2-19"><a href="#cb2-19"></a>    <span class="at">values_to =</span> <span class="st">"value"</span>,  </span>
<span id="cb2-20"><a href="#cb2-20"></a>    <span class="at">names_prefix =</span> <span class="st">"t"</span>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">library</span>(glmmTMB)</span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a>mod<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(value <span class="sc">~</span> <span class="dv">1</span><span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> id), <span class="at">data =</span> df_long)</span>
<span id="cb3-4"><a href="#cb3-4"></a></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="fu">summary</span>(mod<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian  ( identity )
Formula:          value ~ 1 + (1 | id)
Data: df_long

      AIC       BIC    logLik -2*log(L)  df.resid 
  16136.7   16153.5   -8065.4   16130.7      1997 

Random effects:

Conditional model:
 Groups   Name        Variance Std.Dev.
 id       (Intercept) 408.95   20.22   
 Residual              40.45    6.36   
Number of obs: 2000, groups:  id, 1000

Dispersion estimate for gaussian family (sigma^2): 40.4 

Conditional model:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  72.7539     0.6551   111.1   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>Level 1 <span class="math display">\[{Y}_{ti} = \beta_{0i}  + \varepsilon_{ti}\]</span></p>
<p>Level 2 <span class="math display">\[{\beta}_{0i} = \gamma_{00} + U_{0i}\]</span></p>
<p><span class="math display">\[{U}_{0i} \sim\mathcal{N}(0, \tau_{00}^{2})\]</span> <span class="math display">\[{e}_{ti} \sim\mathcal{N}(0, \sigma^{2})\]</span></p>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb5-2"><a href="#cb5-2"></a>mlm <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://raw.githubusercontent.com/josh-jackson/longitudinal-2021/master/example.csv"</span>)</span>
<span id="cb5-3"><a href="#cb5-3"></a>mlm </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 225 × 50
      ID group  time    CON CON_SAL CON_SMN7   DAN DAN_CON DAN_SAL DAN_SMN7
   &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
 1     6 PD        4 0.193   0.0708   0.0088 0.162  0.116   0.0739   0.0041
 2     6 PD        5 0.195   0.0862   0.004  0.168  0.117   0.0812   0.0204
 3     6 PD        6 0.181   0.0916  -0.0037 0.215  0.164   0.113    0.0155
 4    29 PD        4 0.159   0.0438  -0.0253 0.175  0.0161  0.0621   0.0121
 5    29 PD        5 0.0881  0.0446  -0.0288 0.136  0.0377  0.0277   0.0444
 6    34 CTRL      4 0.137   0.0113  -0.0792 0.166  0.0045 -0.0075   0.0432
 7    34 CTRL      6 0.0746  0.0009  -0.0089 0.140  0.0635 -0.024    0.0483
 8    36 CTRL      1 0.139   0.0438  -0.0466 0.152  0.0279  0.0137   0.0513
 9    36 CTRL      4 0.180   0.0772  -0.0648 0.205 -0.0116 -0.0477   0.0415
10    37 PD        3 0.226   0.0412  -0.0565 0.219  0.0971  0.0195   0.0644
# ℹ 215 more rows
# ℹ 40 more variables: DMN6 &lt;dbl&gt;, DMN6_CON &lt;dbl&gt;, DMN6_DAN &lt;dbl&gt;,
#   DMN6_SAL &lt;dbl&gt;, DMN6_SMN7 &lt;dbl&gt;, SAL &lt;dbl&gt;, SAL_SMN7 &lt;dbl&gt;, SMN7 &lt;dbl&gt;,
#   wave &lt;dbl&gt;, date &lt;date&gt;, Exclude &lt;chr&gt;, RSNdata &lt;dbl&gt;, RSNexclude &lt;chr&gt;,
#   RSNexcludeDevDem &lt;chr&gt;, CogDate_0 &lt;date&gt;, CCIRtrio_MR_date_0 &lt;date&gt;,
#   Dur_PDsx_0 &lt;dbl&gt;, PIBpos18 &lt;chr&gt;, Neuro_Dx &lt;chr&gt;, NeuroCDR_0 &lt;chr&gt;,
#   NeuroCDR_1 &lt;chr&gt;, NeuroCDR_2 &lt;chr&gt;, NeuroCDR_3 &lt;chr&gt;, NeuroCDR_4 &lt;chr&gt;, …</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># Function to sample people and their observations</span></span>
<span id="cb7-2"><a href="#cb7-2"></a></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb7-4"><a href="#cb7-4"></a>sample_n_of <span class="ot">&lt;-</span> <span class="cf">function</span>(data, size, ...) {</span>
<span id="cb7-5"><a href="#cb7-5"></a>  dots <span class="ot">&lt;-</span> <span class="fu">quos</span>(...)</span>
<span id="cb7-6"><a href="#cb7-6"></a>  </span>
<span id="cb7-7"><a href="#cb7-7"></a>  group_ids <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb7-8"><a href="#cb7-8"></a>    <span class="fu">group_by</span>(<span class="sc">!!!</span> dots) <span class="sc">%&gt;%</span> </span>
<span id="cb7-9"><a href="#cb7-9"></a>    <span class="fu">group_indices</span>()</span>
<span id="cb7-10"><a href="#cb7-10"></a>  </span>
<span id="cb7-11"><a href="#cb7-11"></a>  sampled_groups <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">unique</span>(group_ids), size)</span>
<span id="cb7-12"><a href="#cb7-12"></a>  data <span class="sc">%&gt;%</span> </span>
<span id="cb7-13"><a href="#cb7-13"></a>    <span class="fu">filter</span>(group_ids <span class="sc">%in%</span> sampled_groups)</span>
<span id="cb7-14"><a href="#cb7-14"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="empty-model" class="slide level2">
<h2>Empty model</h2>
<p>Level 1 <span class="math display">\[{Y}_{ti} = \beta_{0i}  + \varepsilon_{ti}\]</span></p>
<p>Level 2 <span class="math display">\[{\beta}_{0i} = \gamma_{00} + U_{0i}\]</span></p>
<p><span class="math display">\[{U}_{0i} \sim\mathcal{N}(0, \tau_{00}^{2})\]</span></p>
<p><span class="math display">\[{e}_{ti} \sim\mathcal{N}(0, \sigma^{2})\]</span></p>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb8-2"><a href="#cb8-2"></a>mlm <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>  <span class="fu">sample_n_of</span>(<span class="dv">8</span>, ID) <span class="sc">%&gt;%</span> </span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> CON, <span class="at">group =</span> ID)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(ID))) <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(ID)), <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula=</span>y<span class="sc">~</span><span class="dv">1</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"time"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Y"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-2_files/figure-revealjs/unnamed-chunk-6-1.png" width="960" class="r-stretch"><p><span class="math display">\[{Y}_{ti} = \gamma_{00} + U_{0i}  + \varepsilon_{ti}\]</span></p>
<p>Akin to ANOVA if we treat <span class="math inline">\(U_{0i}\)</span> as between subjects variance &amp; <span class="math inline">\(\varepsilon_{ti}\)</span> as within subjects variance.</p>
</section>
<section id="mlm-intuitions" class="slide level2">
<h2>MLM intuitions</h2>
<p>Anytime you have repeated DVs you should use MLM as opposed to doing aggregation outside the model. While that should be your default, it is helpful to conceptualize why it is helpful.</p>
<ol type="1">
<li>Aggregation is bad</li>
<li>Regressions within regressions (ie coefficients as outcomes)</li>
<li>Questions at different levels</li>
<li>Variance decomposition</li>
<li>Learning from other data through pooling/shrinkage</li>
</ol>
</section>
<section id="handling-multiple-dvs" class="slide level2">
<h2>Handling multiple DVs?</h2>
<p>What if people had more than 1 DV, like we do with time? What do you do with multiple items, multiple trials, multiple _____?</p>
<p>Two options: 1. Collapse and average across.</p>
</section>
<section id="example" class="slide level2">
<h2>Example</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="fu">library</span>(broom)</span>
<span id="cb9-3"><a href="#cb9-3"></a></span>
<span id="cb9-4"><a href="#cb9-4"></a>simp<span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb9-5"><a href="#cb9-5"></a>  <span class="sc">~</span>ID, <span class="sc">~</span>group,  <span class="sc">~</span>test.score, <span class="sc">~</span>study,</span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">1</span>,</span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">3</span>,</span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">2</span>,</span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">6</span>,<span class="dv">4</span>,</span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,</span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="dv">6</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">5</span>,</span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="dv">7</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">4</span>,</span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="dv">8</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">6</span>,</span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="dv">9</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">5</span>,</span>
<span id="cb9-15"><a href="#cb9-15"></a><span class="dv">10</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>

<img data-src="mlm-2_files/figure-revealjs/unnamed-chunk-8-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>Could aggragate across group</p>

<img data-src="mlm-2_files/figure-revealjs/unnamed-chunk-10-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">


<img data-src="mlm-2_files/figure-revealjs/unnamed-chunk-11-1.png" width="960" class="r-stretch"></section>
<section id="aggregation-obscures-hypotheses" class="slide level2">
<h2>1. Aggregation obscures hypotheses</h2>
<ul>
<li><p>Between person H1: Do students who study more get better grades?</p></li>
<li><p>Within person H2: When a student studies, do they get better grades?</p></li>
<li><p>H1 and H2 are independent from one another! Aggregation collapses the two. When you have nested data with many DVs it is important to not aggregate.</p></li>
</ul>
</section>
<section id="regressions-within-regressions" class="slide level2">
<h2>2. Regressions within regressions</h2>
<p>Helps to take multilevel and split it into the different levels.</p>
<p>Level 1 is the smallest unit of analysis (students, waves, trials, family members)</p>
<p>Level 2 variables are what level 1 variables are “nested” in (people, schools, counties, families, dyads)</p>
<p>We are going to use level one components to run a regression, all the while level 1 is also estimating a regression. (Coefficents as outcomes)</p>
</section>
<section id="longitudinal-example" class="slide level2">
<h2>Longitudinal example</h2>
<p>Level 1 can be thought of as regressions for each person with time as a predictor. Time can be a simple vector of integers indicating wave, year, hour, etc.</p>
<p><span class="math display">\[Y_\text{josh} = \beta_{0josh} + \beta_{1josh} + \varepsilon_\text{josh}\]</span></p>
<p>We are going to run regressions for each person in the dataset, N = 1.</p>
</section>
<section class="slide level2">

<ul>
<li><p>After we run regressions for everyone at level 1, we are going to summarize each person’s line based on their starting value <span class="math inline">\(\beta_{0i}\)</span> and their slope <span class="math inline">\(\beta_{1i}\)</span></p></li>
<li><p>We now have a vector of starting values (1 for each person) and a vector of slopes (one for each person).</p></li>
<li><p>We are going to treat these vectors as DVs in level 2, and fit regressions.</p></li>
</ul>
</section>
<section class="slide level2">

<p>L1: <span class="math display">\[Y_{time, i} = \beta_{0i} + \beta_{1i}X_{time,i} + \varepsilon_{time,i}\]</span> L2:</p>
<p><span class="math display">\[\beta_{0i} = \gamma_{00} + U_{0i}\]</span> <span class="math display">\[\beta_{1i} = \gamma_{10} + U_{1i}\]</span></p>
</section>
<section class="slide level2">

<p><span class="math display">\[\beta_{0i} = \gamma_{00} + U_{0i}\]</span></p>
<ul>
<li><p>Each of the vectors from level 1 can be decomposed further by a simple regression.</p></li>
<li><p>The level 2 intercept (<span class="math inline">\(\gamma_{00}\)</span>) can be thought of as the average effect, just like in our null “intercept only models”</p></li>
<li><p>The residual (<span class="math inline">\(U_{0i}\)</span>) serves as our way to allow people (or whatever grouping variable) to differ from the average.</p></li>
</ul>
</section>
<section class="slide level2">

<ul>
<li>The logic applies to any level 1 variable that is turned into a level 2 DV.</li>
</ul>
<p><span class="math display">\[\beta_{1i} = \gamma_{10} + U_{1i}\]</span> - Here our slope is the dv, the intercept <span class="math inline">\(\gamma_{10}\)</span> reflects the average and the residual <span class="math inline">\(U_{1i}\)</span> reflects person level deviations.</p>
<ul>
<li>We can treat this like any other regression, adding terms to test hypothesis that end up changing the value of other coefficients.</li>
</ul>
<p><span class="math display">\[\beta_{1i} = \gamma_{10} + \gamma_{11}EDU + U_{1i}\]</span></p>
</section>
<section id="some-reminders" class="slide level2">
<h2>Some reminders</h2>
<ul>
<li><p>Any level 1 variable is automatically a level 2. Your choice if you want to keep with a single average (fixed effect) or if you also want to model a random effect, though we will “keep it maximal”</p></li>
<li><p>Random effects are (typically) deviation scores, and thus need to be interpreted with dispersion estimates</p></li>
<li><p>The interpretation of coefficients are dictated by regression 101 rules. Remember: centering, dummy/effect coding, links, etc.</p></li>
</ul>
</section>
<section id="different-types-of-hypotheses" class="slide level2">
<h2>3. Different types of hypotheses</h2>
<p>To sum up the first two ways to think about regression, we take a relationship that could be simplified by aggregation, and conduct regressions from regressions. (Regression inception).</p>
<p>The third way is to think of questions at different levels. One difficulty people have is mixing types of questions.</p>
<p>At level 1 we can ask lower-unit questions e.g., if you are stressed at one time point, will you have higher scores? Differentiates fluctuations vs level 2-long term change</p>
</section>
<section class="slide level2">

<p>At level 2 we can ask broader-unit questions. E.g., are stressful life events associated with change</p>
<p>Often level 2 is between person variables.</p>
<p>Both levels are simple regressions. Level 2 uses coefficients from level 1 as DVs. Level 1 variables are time varying, while level 2 variables are time invariant.</p>
</section>
<section id="variance-decomposition" class="slide level2">
<h2>4. Variance decomposition</h2>
<p>For standard regression, we think of error as existing in one big bucket called <span class="math inline">\(\varepsilon\)</span> . Everything that we do not know goes into that bucket, from measurement error to missing variables.</p>
<p>For MLMs we will be breaking up ( <span class="math inline">\(\varepsilon\)</span> ) into multiple buckets (Us; random/varying effects) that reflect person level deviations across.</p>
<p>If we are interested in individual differences in intraindividual change, we must have a model that is capable of person specific predictions.</p>
</section>
<section class="slide level2">

<ul>
<li>Most studies present fixed effect findings, focusing on the person average effect. Often we are going to be interested in deviations from the effect. We model these person specifics through our random effects.</li>
</ul>
<p><span class="math display">\[Y_{t i} = \beta_{0i} + \beta_{1i}X_{t i} + \varepsilon_{ti}\]</span></p>
<p><span class="math display">\[\beta_{0} = \gamma_{00} + U_{0i}\]</span> <span class="math display">\[\beta_{1} = \gamma_{10} +\gamma_{11}Z_i+ U_{1i}\]</span></p>
</section>
<section class="slide level2">


<img data-src="btw.png" class="r-stretch"><p>Assume a simple pre-post null model with long data. Y ~ 1.</p>
</section>
<section class="slide level2">


<img data-src="win.png" class="r-stretch"><p>A MLM intercept only model [y ~ 1 + (1 |ID)] takes what was previously chalked up to error and reassigns it into person specific “buckets”</p>
</section>
<section class="slide level2">

<ul>
<li><p>We will treat random effects as variables themselves e.g.&nbsp;individual differences in change. They index how much people DIFFER on some effect.</p></li>
<li><p>We can relate the random effects to other random effects e.g., do people who increase faster also start higher?</p></li>
<li><p>We can make person specific predictions by feeding our regression different values (much like we create a regression line by feeding the equation different values of X).</p></li>
</ul>
</section>
<section id="shrinkagepartial-pooling" class="slide level2">
<h2>5. Shrinkage/partial pooling</h2>
<ul>
<li><p>We treat our group variable as coming from a population. All groups are alike (because they are from the same population), but different in their own way. Because of this it is helpful to use information from other groups to help make predictions.</p></li>
<li><p>We do this in standard regression where we make predictions based on values from the whole dataset (not just binned Xs). A similar analogy for MLM is running a regression for each group. We want to pool as this leads to better predictions as we are not over fitting our data!</p></li>
</ul>
</section>
<section class="slide level2">

<p>If we take an empty model</p>
<p><span class="math display">\[Y_{time, i} = \beta_{0i} +  \varepsilon_{time, i}\]</span></p>
<p><span class="math display">\[\beta_{0i} = \gamma_{00} + U_{0i}\]</span></p>
<p>Where does <span class="math inline">\(U_{0i}\)</span> come from? If we calculated each by hand, through taking the average assessment for a person i and subtracting that from the grand mean average <span class="math inline">\(\gamma_{00}\)</span>, would that equal <span class="math inline">\(U_{0i}\)</span> ?</p>
</section>
<section id="complete-partial-and-no-pooling" class="slide level2">
<h2>Complete, partial and no pooling</h2>
<ul>
<li><p>Complete assumes everyone is the same, with <span class="math inline">\(U_{0i}\)</span> being zero for everyone.</p></li>
<li><p>No pooling is if we calculate every person’s effect with a regression, subtracting out he grand mean average.</p></li>
<li><p>Partial pooling is in the middle, a weighted average between the two. For those with fewer observations there is less information for a particular individual, thus the complete pooling estimate will be given more weight. If someone has a lot of data, their weighted average is closer to no pooling.</p></li>
<li><p>Partial pooling prevents both over and under fitting of your data, leading to increased out of sample predictions.</p></li>
</ul>
</section>
<section id="complete-pooling" class="slide level2">
<h2>Complete pooling</h2>
<p>Ignores any dependency. Doesn’t learn from others, assumes everyone is the same. Underfits the model.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="fu">ggplot</span>(mlm, <span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> SMN7)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>) <span class="sc">+</span><span class="fu">ylab</span>(<span class="st">"test score"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"study"</span>) <span class="sc">+</span>  <span class="fu">theme</span>(<span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb10-2"><a href="#cb10-2"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-2_files/figure-revealjs/unnamed-chunk-12-1.png" width="960" class="r-stretch"></section>
<section id="no-pooling" class="slide level2">
<h2>No Pooling</h2>
<p>Everyone is unique and we cannot learn from others. Leads to overfitting</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">ggplot</span>(mlm, <span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> SMN7, <span class="at">group =</span> ID)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>( <span class="sc">~</span> ID) <span class="sc">+</span><span class="fu">ylab</span>(<span class="st">"test score"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"study"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-2_files/figure-revealjs/unnamed-chunk-13-1.png" width="960" class="r-stretch"></section>
<section id="partial-pooling-aka-shrinkage-aka-regularization" class="slide level2">
<h2>Partial pooling aka shrinkage aka regularization</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="fu">library</span>(marginaleffects)</span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="fu">library</span>(lme4)</span>
<span id="cb12-4"><a href="#cb12-4"></a>model <span class="ot">&lt;-</span> <span class="fu">lmer</span>(SMN7 <span class="sc">~</span> week <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> week <span class="sc">|</span> ID), <span class="at">data =</span> mlm)</span>
<span id="cb12-5"><a href="#cb12-5"></a></span>
<span id="cb12-6"><a href="#cb12-6"></a>avg_line <span class="ot">&lt;-</span> <span class="fu">predictions</span>(model, <span class="at">newdata =</span> <span class="fu">datagrid</span>(<span class="at">week =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>), </span>
<span id="cb12-7"><a href="#cb12-7"></a>                        <span class="at">re.form =</span> <span class="cn">NA</span>)</span>
<span id="cb12-8"><a href="#cb12-8"></a></span>
<span id="cb12-9"><a href="#cb12-9"></a><span class="fu">predictions</span>(model, <span class="at">newdata =</span> <span class="fu">datagrid</span>(<span class="at">ID =</span> <span class="fu">unique</span>(mlm<span class="sc">$</span>ID), <span class="at">week =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>), <span class="at">allow.new.levels =</span> T) <span class="sc">|&gt;</span> </span>
<span id="cb12-10"><a href="#cb12-10"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb12-11"><a href="#cb12-11"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> estimate, <span class="at">group =</span> ID), </span>
<span id="cb12-12"><a href="#cb12-12"></a>            <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span> </span>
<span id="cb12-13"><a href="#cb12-13"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> avg_line, </span>
<span id="cb12-14"><a href="#cb12-14"></a>            <span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> estimate),</span>
<span id="cb12-15"><a href="#cb12-15"></a>            <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-2_files/figure-revealjs/unnamed-chunk-14-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>Partial pooling aka shrinkage provides the optimal amount of learning from others. Assumes people come from the same distribution but are distinct from one another.</p>
<p>If you have a little data, then the safe bet is to look at the average. If you have a lot of data, you can ignore others.</p>
</section>
<section class="slide level2">

<ul>
<li>Intermission</li>
</ul>
</section>
<section id="basic-longitudinal-models" class="slide level2">
<h2>Basic Longitudinal Models</h2>
<ul>
<li>Null or intercept only model</li>
</ul>
<p>Level 1: <span class="math display">\[{Y}_{ti} = \beta_{0i}  + \varepsilon_{ti}\]</span></p>
<p>Level 2: <span class="math display">\[{\beta}_{0i} = \gamma_{00} + U_{0i}\]</span> Combined: <span class="math display">\[{Y}_{ti} = \gamma_{00} + U_{0i}  + \varepsilon_{ti}\]</span></p>
</section>
<section id="icc" class="slide level2">
<h2>ICC</h2>
<p>Between version variance over total variance. If the ICC is greater than zero, we are breaking standard regression assumptions as this is an index of dependency.</p>
<p><span class="math display">\[\frac{U_{0i}}{U_{0i}+ \varepsilon_{ti}}\]</span></p>
<p>ICC can also be interpreted as the average (or expected) correlation within a nested group, in this case a person. On other words, the ICC is the correlation between any person’s repeated measures (technically residuals).</p>
</section>
<section id="gsoep-example" class="slide level2">
<h2>GSOEP EXAMPLE</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">library</span>(plyr)</span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="fu">library</span>(psych)</span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="fu">library</span>(lme4)</span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="fu">library</span>(brms)</span>
<span id="cb13-7"><a href="#cb13-7"></a></span>
<span id="cb13-8"><a href="#cb13-8"></a>codebook <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://raw.githubusercontent.com/josh-jackson/longitudinal-2021/master/codebook.csv"</span>)</span>
<span id="cb13-9"><a href="#cb13-9"></a></span>
<span id="cb13-10"><a href="#cb13-10"></a>codebook <span class="ot">&lt;-</span> codebook <span class="sc">%&gt;%</span> </span>
<span id="cb13-11"><a href="#cb13-11"></a>    <span class="fu">mutate</span>(<span class="at">old_name =</span> <span class="fu">str_to_lower</span>(old_name))</span>
<span id="cb13-12"><a href="#cb13-12"></a></span>
<span id="cb13-13"><a href="#cb13-13"></a>old.names <span class="ot">&lt;-</span> codebook<span class="sc">$</span>old_name <span class="co"># get old column names</span></span>
<span id="cb13-14"><a href="#cb13-14"></a>new.names <span class="ot">&lt;-</span> codebook<span class="sc">$</span>new_name <span class="co"># get new column names</span></span>
<span id="cb13-15"><a href="#cb13-15"></a></span>
<span id="cb13-16"><a href="#cb13-16"></a>soep <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://raw.githubusercontent.com/josh-jackson/longitudinal-2021/master/soepdata.csv"</span>)</span>
<span id="cb13-17"><a href="#cb13-17"></a></span>
<span id="cb13-18"><a href="#cb13-18"></a> soep <span class="ot">&lt;-</span>  soep <span class="sc">%&gt;%</span> <span class="co"># read in data</span></span>
<span id="cb13-19"><a href="#cb13-19"></a>  <span class="fu">select</span>(<span class="fu">all_of</span>(old.names)) <span class="sc">%&gt;%</span> <span class="co"># select the columns from our codebook</span></span>
<span id="cb13-20"><a href="#cb13-20"></a>  <span class="fu">setNames</span>(new.names) <span class="co"># rename columns with our new names</span></span>
<span id="cb13-21"><a href="#cb13-21"></a></span>
<span id="cb13-22"><a href="#cb13-22"></a></span>
<span id="cb13-23"><a href="#cb13-23"></a>soep <span class="ot">&lt;-</span> soep <span class="sc">%&gt;%</span></span>
<span id="cb13-24"><a href="#cb13-24"></a>  <span class="fu">mutate_all</span>(<span class="sc">~</span><span class="fu">as.numeric</span>(<span class="fu">mapvalues</span>(., <span class="at">from =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">7</span>, <span class="sc">-</span><span class="dv">1</span>), <span class="at">to =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">7</span>), <span class="at">warn_missing =</span> F)))</span>
<span id="cb13-25"><a href="#cb13-25"></a></span>
<span id="cb13-26"><a href="#cb13-26"></a>soep_long <span class="ot">&lt;-</span> soep <span class="sc">%&gt;%</span></span>
<span id="cb13-27"><a href="#cb13-27"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fu">contains</span>(<span class="st">"Procedural"</span>), <span class="sc">-</span><span class="fu">contains</span>(<span class="st">"Demographic"</span>)),</span>
<span id="cb13-28"><a href="#cb13-28"></a>               <span class="at">names_to =</span> <span class="st">"item"</span>, </span>
<span id="cb13-29"><a href="#cb13-29"></a>               <span class="at">values_to =</span> <span class="st">"value"</span>, </span>
<span id="cb13-30"><a href="#cb13-30"></a>               <span class="at">values_drop_na =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-31"><a href="#cb13-31"></a>  <span class="fu">left_join</span>(codebook <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="at">item =</span> new_name, reverse, mini, maxi)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-32"><a href="#cb13-32"></a>  <span class="fu">separate</span>(item, <span class="fu">c</span>(<span class="st">"type"</span>, <span class="st">"item"</span>), <span class="at">sep =</span> <span class="st">"__"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb13-33"><a href="#cb13-33"></a>  <span class="fu">separate</span>(item, <span class="fu">c</span>(<span class="st">"item"</span>, <span class="st">"year"</span>), <span class="at">sep =</span> <span class="st">"[.]"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb13-34"><a href="#cb13-34"></a>  <span class="fu">separate</span>(item, <span class="fu">c</span>(<span class="st">"trait"</span>, <span class="st">"item"</span>), <span class="at">sep =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb13-35"><a href="#cb13-35"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">as.numeric</span>(value), <span class="co"># change to numeric</span></span>
<span id="cb13-36"><a href="#cb13-36"></a>         <span class="at">value =</span> <span class="fu">ifelse</span>(reverse <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>, </span>
<span id="cb13-37"><a href="#cb13-37"></a>            <span class="fu">reverse.code</span>(<span class="sc">-</span><span class="dv">1</span>, value, <span class="at">mini =</span> mini, <span class="at">maxi =</span> maxi), value))</span>
<span id="cb13-38"><a href="#cb13-38"></a></span>
<span id="cb13-39"><a href="#cb13-39"></a>b5_soep_long <span class="ot">&lt;-</span> soep_long <span class="sc">%&gt;%</span></span>
<span id="cb13-40"><a href="#cb13-40"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Big 5"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb13-41"><a href="#cb13-41"></a>  <span class="fu">group_by</span>(Procedural__SID, trait, year) <span class="sc">%&gt;%</span> </span>
<span id="cb13-42"><a href="#cb13-42"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">mean</span>(value, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-43"><a href="#cb13-43"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb13-44"><a href="#cb13-44"></a>  <span class="fu">left_join</span>(soep_long <span class="sc">%&gt;%</span> </span>
<span id="cb13-45"><a href="#cb13-45"></a>    <span class="fu">select</span>(Procedural__SID, <span class="at">DOB =</span> Demographic__DOB, <span class="at">Sex =</span> Demographic__Sex) <span class="sc">%&gt;%</span></span>
<span id="cb13-46"><a href="#cb13-46"></a>    <span class="fu">distinct</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">str</span>(b5_soep_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [151,186 × 6] (S3: tbl_df/tbl/data.frame)
 $ Procedural__SID: num [1:151186] 901 901 901 901 901 901 901 901 901 901 ...
 $ trait          : chr [1:151186] "A" "A" "A" "C" ...
 $ year           : chr [1:151186] "2005" "2009" "2013" "2005" ...
 $ value          : num [1:151186] 4.67 4.33 4.67 5 5 ...
 $ DOB            : num [1:151186] 1951 1951 1951 1951 1951 ...
 $ Sex            : num [1:151186] 2 2 2 2 2 2 2 2 2 2 ...</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>b5_long <span class="ot">&lt;-</span> b5_soep_long <span class="sc">%&gt;%</span> </span>
<span id="cb16-2"><a href="#cb16-2"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> trait, <span class="at">values_from =</span> value) <span class="sc">%&gt;%</span> </span>
<span id="cb16-3"><a href="#cb16-3"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> Procedural__SID) <span class="sc">%&gt;%</span> </span>
<span id="cb16-4"><a href="#cb16-4"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">as.factor</span>(ID))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>b5_long <span class="ot">&lt;-</span>b5_long <span class="sc">%&gt;%</span> </span>
<span id="cb17-2"><a href="#cb17-2"></a>  <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">n</span>() <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-4"><a href="#cb17-4"></a>  <span class="fu">ungroup</span>(ID)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">str</span>(b5_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [22,098 × 10] (S3: tbl_df/tbl/data.frame)
 $ Procedural__SID: num [1:22098] 901 901 901 2301 2301 ...
 $ year           : chr [1:22098] "2005" "2009" "2013" "2005" ...
 $ DOB            : num [1:22098] 1951 1951 1951 1946 1946 ...
 $ Sex            : num [1:22098] 2 2 2 1 1 1 2 2 2 2 ...
 $ A              : num [1:22098] 4.67 4.33 4.67 5.67 5.67 ...
 $ C              : num [1:22098] 5 5 5 5.67 5 ...
 $ E              : num [1:22098] 5 5 5 5 4 ...
 $ N              : num [1:22098] 4 4.67 4.33 4.33 5.33 ...
 $ O              : num [1:22098] 4 4 3.33 4.33 5 ...
 $ ID             : Factor w/ 16719 levels "901","1202","2301",..: 1 1 1 3 3 3 4 4 4 7 ...</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>mod<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(C <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID), <span class="at">data=</span>b5_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="fu">summary</span>(mod<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian  ( identity )
Formula:          C ~ 1 + (1 | ID)
Data: b5_long

      AIC       BIC    logLik -2*log(L)  df.resid 
  42778.3   42802.3  -21386.2   42772.3     22078 

Random effects:

Conditional model:
 Groups   Name        Variance Std.Dev.
 ID       (Intercept) 0.1379   0.3713  
 Residual             0.3008   0.5485  
Number of obs: 22081, groups:  ID, 8565

Dispersion estimate for gaussian family (sigma^2): 0.301 

Conditional model:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) 4.760256   0.005478     869   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="fu">library</span>(parameters) </span>
<span id="cb23-2"><a href="#cb23-2"></a></span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="fu">model_parameters</span>(mod<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Fixed Effects

Parameter   | Coefficient |       SE |       95% CI |      z |      p
---------------------------------------------------------------------
(Intercept) |        4.76 | 5.48e-03 | [4.75, 4.77] | 868.96 | &lt; .001

# Random Effects

Parameter          | Coefficient
--------------------------------
SD (Intercept: ID) |        0.37
SD (Residual)      |        0.55</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>ICC By hand or</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="fu">library</span>(performance) </span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="fu">model_performance</span>(mod<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC       |      AICc |       BIC | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma
-----------------------------------------------------------------------------------
42778.338 | 42778.339 | 42802.346 |      0.314 |      0.000 | 0.314 | 0.488 | 0.548</code></pre>
</div>
</div>
</section>
<section id="what-do-the-random-effects-look-like" class="slide level2">
<h2>what do the random effects look like?</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="fu">library</span>(modelbased)</span>
<span id="cb27-2"><a href="#cb27-2"></a>random <span class="ot">&lt;-</span> <span class="fu">estimate_grouplevel</span>(mod<span class="fl">.1</span>) </span>
<span id="cb27-3"><a href="#cb27-3"></a><span class="fu">head</span>(random)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Group | Level |   Parameter | Coefficient |   SE |        95% CI |   Component
------------------------------------------------------------------------------
ID    |   901 | (Intercept) |        0.14 | 0.24 | [-0.33, 0.61] | conditional
ID    |  2301 | (Intercept) |        0.33 | 0.24 | [-0.14, 0.80] | conditional
ID    |  2302 | (Intercept) |        0.27 | 0.24 | [-0.20, 0.74] | conditional
ID    |  4701 | (Intercept) |       -0.04 | 0.27 | [-0.57, 0.48] | conditional
ID    |  4901 | (Intercept) |        0.01 | 0.24 | [-0.46, 0.48] | conditional
ID    |  5201 | (Intercept) |        0.59 | 0.24 | [ 0.12, 1.06] | conditional</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="fu">library</span>(see)</span>
<span id="cb29-2"><a href="#cb29-2"></a>random <span class="sc">%&gt;%</span> </span>
<span id="cb29-3"><a href="#cb29-3"></a><span class="fu">sample_n</span>(<span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb29-4"><a href="#cb29-4"></a><span class="fu">plot</span>(.) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-2_files/figure-revealjs/unnamed-chunk-25-1.png" width="960" class="r-stretch"></section>
<section id="predicted-scores" class="slide level2">
<h2>Predicted scores</h2>
<p>Predictors are super important for evaluating our model as well as graphing. Lots of packages have these capabilities. My favorites are tidybayes (for brms), modelr (for all), marginaleffects (for all), and modelbased (for all).</p>
<p>These extend the flexibility of predict (base) and similar functions from emmeans</p>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="fu">library</span>(modelbased)</span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="fu">estimate_prediction</span>(mod<span class="fl">.1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb30-3"><a href="#cb30-3"></a>  <span class="fu">head</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model-based Prediction

ID   | Predicted |   SE |       95% CI | Residuals
--------------------------------------------------
901  |      4.90 | 0.24 | [4.43, 5.37] |      0.10
901  |      4.90 | 0.24 | [4.43, 5.37] |      0.10
901  |      4.90 | 0.24 | [4.43, 5.37] |      0.10
2301 |      5.09 | 0.24 | [4.62, 5.56] |      0.57
2301 |      5.09 | 0.24 | [4.62, 5.56] |     -0.09
2301 |      5.09 | 0.24 | [4.62, 5.56] |      0.24

Variable predicted: C</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="fu">library</span>(marginaleffects)</span>
<span id="cb32-2"><a href="#cb32-2"></a></span>
<span id="cb32-3"><a href="#cb32-3"></a><span class="fu">predictions</span>(mod<span class="fl">.1</span>) <span class="sc">%&gt;%</span>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Estimate Std. Error   z Pr(&gt;|z|)   S 2.5 % 97.5 %
     4.90    0.00548 894   &lt;0.001 Inf  4.89   4.91
     4.90    0.00548 894   &lt;0.001 Inf  4.89   4.91
     4.90    0.00548 894   &lt;0.001 Inf  4.89   4.91
     5.09    0.00548 929   &lt;0.001 Inf  5.08   5.10
     5.09    0.00548 929   &lt;0.001 Inf  5.08   5.10
     5.09    0.00548 929   &lt;0.001 Inf  5.08   5.10

Type:  response 
Columns: rowid, estimate, std.error, statistic, p.value, s.value, conf.low, conf.high, C, ID </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="fu">predictions</span>(mod<span class="fl">.1</span>, <span class="at">newdata =</span> <span class="fu">datagrid</span>(<span class="at">ID =</span> <span class="fu">c</span>(<span class="dv">901</span>, <span class="dv">2301</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   ID Estimate Std. Error   z Pr(&gt;|z|)   S 2.5 % 97.5 %
 901      4.90    0.00548 894   &lt;0.001 Inf  4.89   4.91
 2301     5.09    0.00548 929   &lt;0.001 Inf  5.08   5.10

Type:  response 
Columns: rowid, estimate, std.error, statistic, p.value, s.value, conf.low, conf.high, ID, C </code></pre>
</div>
</div>
</section>
<section id="within-person-empty-null-model" class="slide level2">
<h2>Within person empty null model</h2>
<p><span class="math display">\[{Y}_{ti} = \gamma_{00} + U_{0i}  + \varepsilon_{ti}\]</span></p>
<p>This model is helpful in producing the simplest longitudinal model, one where it states: there is an average value <span class="math inline">\(\gamma_{00}\)</span> that people differ along <span class="math inline">\(U_{0i}\)</span> . Because time is not in the model it assumes people do not change. <span class="math inline">\(\varepsilon_{ti}\)</span> reflects variation around each person’s predicted score ( <span class="math inline">\(\gamma_{00} + U_{0i}\)</span> ).</p>
</section>
<section id="growth-model" class="slide level2">
<h2>Growth model</h2>
<p>Growth model is just a fancy term for including TIME as our level 1 predictor where we are now creating lines for each person.</p>
<p>Level 1: <span class="math display">\[{Y}_{ti} = \beta_{0i}  + \beta_{1i}Time_{ti} + \varepsilon_{ti}\]</span> Because we have a level 1 time predictor in the model, we are now asking the question, how does time influence scores on our DV? Because all regressions are linear by default, it asks if there is an association such that as time increases does the DV?</p>
</section>
<section class="slide level2">

<p>Level 2 takes the parameters at level 1 and decomposes them into a fixed component ( <span class="math inline">\(\gamma\)</span> ) that reflects the average and, if desired, the individual deviations around that fixed effect (U).</p>
<p>level 1 <span class="math display">\[{Y}_{ti} = \beta_{0i}  + \beta_{1j}Time_{ti} + \varepsilon_{ti}\]</span></p>
<p>level 2 <span class="math display">\[{\beta}_{0i} = \gamma_{00} + U_{0i}\]</span><br>
<span class="math display">\[{\beta}_{1i} = \gamma_{10}\]</span></p>
</section>
<section class="slide level2">

<p>Combined equation: <span class="math display">\[{Y}_{ti} = \gamma_{00} + \gamma_{10} (\text{time}_{1i})+ U_{0i}  + \varepsilon_{ti}\]</span></p>
<p>Combined with random slope: <span class="math display">\[{Y}_{ti} = \gamma_{00} + \gamma_{10}(time_{ti})+ U_{0i} + U_{1i}(time_{ti}) + \varepsilon_{ti}\]</span></p>
<p>Can think of a persons score divided up into a fixed component as well as the random component.</p>
<p><span class="math display">\[{\beta}_{1.6} = \gamma_{10} \pm U_{1.6}\]</span></p>
</section>
<section class="slide level2">

<p>Notice how if we constrain random effects this just turns into a simple regression</p>
<p>level 1 <span class="math display">\[{Y}_{ti} = \beta_{0i}  + \beta_{1i}\text{time}_{ti} + \varepsilon_{ti}\]</span></p>
<p>level 2 <span class="math display">\[{\beta}_{0i} = \gamma_{00} \]</span><br>
</p>
<p><span class="math display">\[{\beta}_{1i} = \gamma_{10}\]</span></p>
</section>
<section id="the-role-of-time" class="slide level2">
<h2>The role of time</h2>
<ul>
<li><p>If we change the time variable, we change the interpretation of the growth curve (age vs time in study).</p></li>
<li><p>As with all regressions, zero is important.</p></li>
<li><p>Our time variable can be categorical or continuous, most often it is centered around some meaningful time (initial status, average age, etc).</p></li>
</ul>
</section>
<section id="growth-curve-example" class="slide level2">
<h2>Growth curve example</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>mod<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(C <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> year <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID), <span class="at">data=</span>b5_long)</span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="fu">summary</span>(mod<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian  ( identity )
Formula:          C ~ 1 + year + (1 | ID)
Data: b5_long

      AIC       BIC    logLik -2*log(L)  df.resid 
  42779.9   42819.9  -21385.0   42769.9     22076 

Random effects:

Conditional model:
 Groups   Name        Variance Std.Dev.
 ID       (Intercept) 0.1378   0.3712  
 Residual             0.3008   0.5485  
Number of obs: 22081, groups:  ID, 8565

Dispersion estimate for gaussian family (sigma^2): 0.301 

Conditional model:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) 4.752544   0.007566   628.2   &lt;2e-16 ***
year2009    0.009781   0.008756     1.1    0.264    
year2013    0.014583   0.009774     1.5    0.136    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>b5_long<span class="ot">&lt;-</span> b5_long <span class="sc">%&gt;%</span>  </span>
<span id="cb38-2"><a href="#cb38-2"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">as.numeric</span>(year))</span>
<span id="cb38-3"><a href="#cb38-3"></a>  </span>
<span id="cb38-4"><a href="#cb38-4"></a>mod<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">lmer</span>(C <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> year <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID), <span class="at">data=</span>b5_long)</span>
<span id="cb38-5"><a href="#cb38-5"></a><span class="fu">summary</span>(mod<span class="fl">.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: C ~ 1 + year + (1 | ID)
   Data: b5_long

REML criterion at convergence: 42790.2

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-6.3016 -0.4591  0.0529  0.4182  4.7556 

Random effects:
 Groups   Name        Variance Std.Dev.
 ID       (Intercept) 0.1378   0.3712  
 Residual             0.3009   0.5485  
Number of obs: 22081, groups:  ID, 8565

Fixed effects:
            Estimate Std. Error t value
(Intercept) 1.034489   2.445847   0.423
year        0.001855   0.001218   1.523

Correlation of Fixed Effects:
     (Intr)
year -1.000</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<h3 id="the-importance-of-scaling-time">The importance of scaling time</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>b5_long<span class="ot">&lt;-</span> b5_long <span class="sc">%&gt;%</span>  </span>
<span id="cb40-2"><a href="#cb40-2"></a>  <span class="fu">mutate</span>(<span class="at">year.c =</span> (year <span class="sc">-</span> <span class="dv">2005</span>))</span>
<span id="cb40-3"><a href="#cb40-3"></a>  </span>
<span id="cb40-4"><a href="#cb40-4"></a>  </span>
<span id="cb40-5"><a href="#cb40-5"></a>mod<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">lmer</span>(C <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> year.c <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ID), <span class="at">data=</span>b5_long)</span>
<span id="cb40-6"><a href="#cb40-6"></a><span class="fu">summary</span>(mod<span class="fl">.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: C ~ 1 + year.c + (1 | ID)
   Data: b5_long

REML criterion at convergence: 42790.2

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-6.3016 -0.4591  0.0529  0.4182  4.7556 

Random effects:
 Groups   Name        Variance Std.Dev.
 ID       (Intercept) 0.1378   0.3712  
 Residual             0.3009   0.5485  
Number of obs: 22081, groups:  ID, 8565

Fixed effects:
            Estimate Std. Error t value
(Intercept) 4.753403   0.007088 670.621
year.c      0.001855   0.001218   1.523

Correlation of Fixed Effects:
       (Intr)
year.c -0.635</code></pre>
</div>
</div>
</section>
<section id="visualizing-results-quickly" class="slide level2">
<h2>Visualizing results (quickly)</h2>
<p>There are many ways to do this. The parameters package paired with the see package, both from the easystats package, are useful in this regard.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="fu">library</span>(parameters)</span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="fu">library</span>(see)</span>
<span id="cb42-3"><a href="#cb42-3"></a></span>
<span id="cb42-4"><a href="#cb42-4"></a>result <span class="ot">&lt;-</span> <span class="fu">model_parameters</span>(mod<span class="fl">.4</span>)</span>
<span id="cb42-5"><a href="#cb42-5"></a>result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Fixed Effects

Parameter   | Coefficient |       SE |        95% CI | t(22077) |      p
------------------------------------------------------------------------
(Intercept) |        4.75 | 7.09e-03 | [ 4.74, 4.77] |   670.62 | &lt; .001
year c      |    1.85e-03 | 1.22e-03 | [ 0.00, 0.00] |     1.52 | 0.128 

# Random Effects

Parameter          | Coefficient
--------------------------------
SD (Intercept: ID) |        0.37
SD (Residual)      |        0.55</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="fu">plot</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="mlm-2_files/figure-revealjs/unnamed-chunk-33-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a>result2 <span class="ot">&lt;-</span> <span class="fu">simulate_parameters</span>(mod<span class="fl">.4</span>)</span>
<span id="cb45-2"><a href="#cb45-2"></a><span class="fu">plot</span>(result2, <span class="at">show_intercept =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-2_files/figure-revealjs/unnamed-chunk-34-1.png" width="960" class="r-stretch"></section>
<section id="feed-our-model" class="slide level2">
<h2>Feed our model</h2>
<ul>
<li><p>These graphs however just take your summary output and make it look nice.</p></li>
<li><p>If we want to say, plot the predicted line we need to do an additional step and FEED the data back into the model. Same as with graphing simple regressions</p></li>
<li><p>The logic is simple: 1. fit model. 2. create grid that defines points to plot 3. feed grid into model to create predictions</p></li>
</ul>
</section>
<section class="slide level2">

<p>Rewriting slope equation to highlight what simple slope we want to graph. Just have to choose what we want to fix and what we want to vary</p>
<p><span class="math display">\[\hat{Y}_{ti} = [\gamma_{00}] + [\gamma_{10}   ]  * Time_{ti}\]</span> No random effects, because we wanted the expected value of the sample (or fixed effect) estimate graphed</p>
</section>
<section class="slide level2">

<p>Some packages do so much behind the scenes it is hard to know what is happening</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb46-2"><a href="#cb46-2"></a>p.mod4<span class="ot">&lt;-</span><span class="fu">ggpredict</span>(mod<span class="fl">.4</span>, <span class="st">"year.c"</span>)</span>
<span id="cb46-3"><a href="#cb46-3"></a>p.mod4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Predicted values of C

year.c | Predicted |     95% CI
-------------------------------
     0 |      4.75 | 4.74, 4.77
     4 |      4.76 | 4.75, 4.77
     8 |      4.77 | 4.75, 4.78

Adjusted for:
* ID = 0 (population-level)</code></pre>
</div>
</div>
<p>Automatically chooses levels [0,4,8]</p>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="fu">plot</span>(p.mod4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="mlm-2_files/figure-revealjs/unnamed-chunk-36-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>If you want you can also get predicted lines for a particular individual. I really like the package marignaleffects as it is more flexible than ggeffects</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="fu">library</span>(marginaleffects)</span>
<span id="cb49-2"><a href="#cb49-2"></a>p.r.mod2 <span class="ot">&lt;-</span> <span class="fu">predictions</span>(mod<span class="fl">.4</span>, </span>
<span id="cb49-3"><a href="#cb49-3"></a>          <span class="at">newdata =</span> </span>
<span id="cb49-4"><a href="#cb49-4"></a>          <span class="fu">datagrid</span>(<span class="at">ID =</span> unique, </span>
<span id="cb49-5"><a href="#cb49-5"></a>                   <span class="at">year.c =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">8</span>))</span>
<span id="cb49-6"><a href="#cb49-6"></a></span>
<span id="cb49-7"><a href="#cb49-7"></a>p.r.mod2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
      ID year.c Estimate Std. Error   z Pr(&gt;|z|)   S 2.5 % 97.5 %
 901          0     4.89    0.00709 690   &lt;0.001 Inf  4.88   4.91
 901          1     4.89    0.00638 766   &lt;0.001 Inf  4.88   4.91
 901          2     4.90    0.00585 836   &lt;0.001 Inf  4.88   4.91
 901          3     4.90    0.00554 884   &lt;0.001 Inf  4.89   4.91
 901          4     4.90    0.00549 892   &lt;0.001 Inf  4.89   4.91
--- 77075 rows omitted. See ?avg_predictions and ?print.marginaleffects --- 
 8280702      4     4.79    0.00549 873   &lt;0.001 Inf  4.78   4.80
 8280702      5     4.80    0.00570 841   &lt;0.001 Inf  4.78   4.81
 8280702      6     4.80    0.00615 779   &lt;0.001 Inf  4.79   4.81
 8280702      7     4.80    0.00680 706   &lt;0.001 Inf  4.79   4.81
 8280702      8     4.80    0.00758 633   &lt;0.001 Inf  4.79   4.82
Type:  response 
Columns: rowid, estimate, std.error, statistic, p.value, s.value, conf.low, conf.high, ID, year.c, C </code></pre>
</div>
</div>
<p><span class="math display">\[\hat{Y}_{ti} = [\gamma_{00} + U_{0i}] + [\gamma_{10}+U_{1i} ]  * Time_{ti}\]</span></p>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a>p.r.mod2 <span class="sc">|&gt;</span> </span>
<span id="cb51-2"><a href="#cb51-2"></a><span class="fu">sample_n_of</span>(<span class="dv">74</span>, ID) <span class="sc">|&gt;</span> </span>
<span id="cb51-3"><a href="#cb51-3"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(year.c, estimate, <span class="at">level =</span> ID)) <span class="sc">+</span></span>
<span id="cb51-4"><a href="#cb51-4"></a>  <span class="fu">geom_line</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-2_files/figure-revealjs/unnamed-chunk-38-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="fu">predictions</span>(mod<span class="fl">.4</span>, </span>
<span id="cb52-2"><a href="#cb52-2"></a>          <span class="at">newdata =</span> </span>
<span id="cb52-3"><a href="#cb52-3"></a>          <span class="fu">datagrid</span>(<span class="at">year.c =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">8</span>), </span>
<span id="cb52-4"><a href="#cb52-4"></a>                   <span class="at">re.form =</span> <span class="cn">NA</span>) <span class="sc">|&gt;</span> </span>
<span id="cb52-5"><a href="#cb52-5"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year.c, <span class="at">y =</span> estimate, <span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high)) <span class="sc">+</span></span>
<span id="cb52-6"><a href="#cb52-6"></a>  <span class="fu">geom_ribbon</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">fill =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb52-7"><a href="#cb52-7"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-2_files/figure-revealjs/unnamed-chunk-39-1.png" width="960" class="r-stretch"></section>
<section id="mlm-as-default-and-make-it-maximum" class="slide level2">
<h2>MLM as default and make it maximum</h2>
<p>If you don’t include all random effects then you are losing information (GEE being a potential exception).</p>
<p>The question often is necessitated by model convergence. There are multiple opinions, but mine is to start maximum, and then work downward (ie simplify) if necessary/consistent with theory. It doesn’t really hurt to include them, especially with new estimation advances (Bayesian estimation)</p>
</section>
<section id="error-structure" class="slide level2">
<h2>Error Structure</h2>
<p>The residual structure, where the random effects are again normally distributed with a mean of zero, but this time one must also consider covariance in addition to variance.</p>
<p>G matrix (books term, some call tau matrix) <span class="math display">\[\begin{pmatrix} {U}_{0j} \\ {U}_{1j} \end{pmatrix}
\sim \mathcal{N} \begin{pmatrix}
  0,      \tau_{00}^{2} &amp; \tau_{01}\\
  0,  \tau_{01} &amp; \tau_{10}^{2}
\end{pmatrix}\]</span></p>
</section>
<section class="slide level2">

<p><span class="math display">\[{e}_{ij} \sim \mathcal{N}(0, \sigma^{2})\]</span> The <span class="math inline">\({e}_{ij}\)</span> is structured as a NxN matrix (R matrix), where n reflect number of waves. Usually assumed uncorrelated with equal variance across observations</p>
<p>Indexes within person variation</p>
</section>
<section id="decomposing-variance-for-random-intercept-model" class="slide level2">
<h2>Decomposing variance for random intercept model</h2>
<p>V matrix = R + G matrices (technically <span class="math inline">\(V_i = Z_iG_iZ{_i}^T + R_i\)</span> where Z = N waves x number of random effects)</p>
<p>Typical assumption is whats called compound symmetry. For an intercept only model the reason waves are correlated are only because of the random effect differences in means.</p>
<p><span class="math display">\[\text{Total variance CS} = \begin{pmatrix}
       \tau_{00}^{2} + \sigma^{2}&amp; \tau_{00}^{2} &amp; \tau_{00}^{2}\\
       \tau_{00}^{2} &amp;  \tau_{00}^{2} + \sigma^{2} &amp;  \tau_{00}^{2}\\
       \tau_{00}^{2} &amp; \tau_{00}^{2} &amp;   \tau_{00}^{2} + \sigma^{2}
\end{pmatrix}\]</span></p>
<p>If people change at different rates, the variances and covariances over time have to change, too.</p>
</section>
<section id="error-assumptions" class="slide level2">
<h2>Error assumptions</h2>
<p>Level 1 residuals are independent for Level 1 units across people<br>
AND</p>
<p>Level 1 residuals are independent of random effects</p>
<p>AND</p>
<p>Level 1 residuals are the same magnitude across people</p>
<p>We can modify a standard assumption: Level 1 residuals are independent within a person through different variance/covariance structures</p>
</section>
<section class="slide level2">

<p>If slopes are different across people, then people differ from each other systematically in 2 ways (U0i and U1i) then compound symmetry will NOT hold</p>
</section>
<section class="slide level2">

<p><span class="math display">\[\mathbf{V}_i =
\begin{bmatrix}
1 &amp; 0 \\
1 &amp; 1 \\
1 &amp; 2 \\
1 &amp; 3
\end{bmatrix}
\begin{bmatrix}
\tau_{U_0}^2 &amp; \tau_{U_{01}} \\
\tau_{U_{01}} &amp; \tau_{U_1}^2
\end{bmatrix}
\begin{bmatrix}
1 &amp; 1 &amp; 1 &amp; 1 \\
0 &amp; 1 &amp; 2 &amp; 3
\end{bmatrix} +
\begin{bmatrix}
\sigma_e^2 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; \sigma_e^2 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; \sigma_e^2 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; \sigma_e^2
\end{bmatrix}\]</span></p>
</section>
<section class="slide level2">

<p>V matrix is time dependent.</p>
<p><span class="math display">\[V_i = \tau_{U_0}^2 + \left[ (\text{time})^2 \tau_{U_1}^2 \right] + \left[ 2(\text{time})\tau_{U_{01}} \right] + \sigma_e^2\]</span></p>
<p>This is because as two people’s slopes differ from one another the outcome variance and covariance must differ over time</p>
</section>
<section class="slide level2">

<p>Two ends of an extreme, similar to no and full pooling.</p>
<ul>
<li><p>Compound Symmetry (CS) is parsimonious but likely not correct.</p></li>
<li><p>Unstructured, where each wave variance and covariance are independent estimated provides a good fit, but likely overfit.</p></li>
<li><p>Random effects V matrix is somewhere, optimally, in between!</p></li>
</ul>
</section>
<section id="revisit-2-wave-assessment" class="slide level2">
<h2>Revisit 2 wave assessment</h2>
<p>Where is our error for a 2 wave model and:</p>
<ul>
<li>Assuming random slopes</li>
<li>Assuming no random slopes</li>
</ul>
</section>
<section id="centering" class="slide level2">
<h2>Centering</h2>
<p>Because mlms are regressions, and because mlms involve interactions, it is important to consider how your predictors zero point is defined.</p>
<p>How do you want your intercept interpreted? How do you want lower order terms in an interaction interpreted?</p>
<p>We will use these extensively to help disentangle within and between person variance.</p>
</section>
<section id="uncentered" class="slide level2">
<h2>Uncentered</h2>
<p>The default will give you predicted score of intercept when all predictors are zero.</p>
<p>Because most models will have a random intercept, it is important to keep in mind interpretations as we will be looking at variations around this value.</p>
</section>
<section id="grand-mean-centered" class="slide level2">
<h2>Grand mean Centered</h2>
<p>Zero now represents that grand mean of the sample. Calculated by taking <span class="math inline">\(x_{ti} - \bar{x}\)</span></p>
<p>Useful as this is often our the default in other methods. Changes meaning of intercept but not slope.</p>
<p>A related way to center is group grand mean centering where you take the mean of your grouping variables rather than the grand mean.</p>
</section>
<section id="group-mean-centering-person-centering" class="slide level2">
<h2>group mean centering (person centering)</h2>
<p>Calculated by taking <span class="math inline">\(x_{ti} - \bar{x_i}\)</span></p>
<p>Can change meaning of intercept and slope. Intercept is now a person’s average level rather than the samples average level (grand mean) and level when predictors = 0 (no centering)</p>
<p>Slope at level 1 is the expected change relative to a person’s average.</p>
</section>
<section id="other-centering-approaches" class="slide level2">
<h2>other centering approaches</h2>
<ul>
<li>can also center around specific events eg time until death or time before and after graduation where graduation is now coded as zero</li>
</ul>
</section>
<section id="as-starting" class="slide level2">
<h2>0 as starting</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="co"># grand mean centering</span></span>
<span id="cb53-2"><a href="#cb53-2"></a></span>
<span id="cb53-3"><a href="#cb53-3"></a>b5_long<span class="ot">&lt;-</span> b5_long <span class="sc">%&gt;%</span>  </span>
<span id="cb53-4"><a href="#cb53-4"></a>  <span class="fu">mutate</span>(<span class="at">year.c =</span> (year <span class="sc">-</span> <span class="dv">2005</span>))</span>
<span id="cb53-5"><a href="#cb53-5"></a>  </span>
<span id="cb53-6"><a href="#cb53-6"></a>  </span>
<span id="cb53-7"><a href="#cb53-7"></a>mod<span class="fl">.6</span> <span class="ot">&lt;-</span> <span class="fu">lmer</span>(C <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> year.c <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> year.c  <span class="sc">|</span> ID), <span class="at">data=</span>b5_long)</span>
<span id="cb53-8"><a href="#cb53-8"></a></span>
<span id="cb53-9"><a href="#cb53-9"></a><span class="fu">summary</span>(mod<span class="fl">.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: C ~ 1 + year.c + (1 + year.c | ID)
   Data: b5_long

REML criterion at convergence: 42714

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-6.0085 -0.4685  0.0460  0.4376  4.8649 

Random effects:
 Groups   Name        Variance Std.Dev. Corr
 ID       (Intercept) 0.105121 0.32422      
          year.c      0.000287 0.01694  0.75
 Residual             0.296605 0.54461      
Number of obs: 22081, groups:  ID, 8565

Fixed effects:
            Estimate Std. Error t value
(Intercept) 4.753235   0.006766  702.56
year.c      0.001783   0.001230    1.45

Correlation of Fixed Effects:
       (Intr)
year.c -0.591</code></pre>
</div>
</div>
</section>
<section id="as-mid" class="slide level2">
<h2>0 as mid</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a>b5_long<span class="ot">&lt;-</span> b5_long <span class="sc">%&gt;%</span>  </span>
<span id="cb55-2"><a href="#cb55-2"></a>  <span class="fu">mutate</span>(<span class="at">year.cM =</span> (year <span class="sc">-</span> <span class="dv">2009</span>))</span>
<span id="cb55-3"><a href="#cb55-3"></a>  </span>
<span id="cb55-4"><a href="#cb55-4"></a>  </span>
<span id="cb55-5"><a href="#cb55-5"></a>mod<span class="fl">.7</span> <span class="ot">&lt;-</span> <span class="fu">lmer</span>(C <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> year.cM <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> year.cM <span class="sc">|</span> ID), <span class="at">data=</span>b5_long)</span>
<span id="cb55-6"><a href="#cb55-6"></a></span>
<span id="cb55-7"><a href="#cb55-7"></a><span class="fu">summary</span>(mod<span class="fl">.7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: C ~ 1 + year.cM + (1 + year.cM | ID)
   Data: b5_long

REML criterion at convergence: 42714

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-6.0085 -0.4685  0.0461  0.4376  4.8649 

Random effects:
 Groups   Name        Variance  Std.Dev. Corr
 ID       (Intercept) 0.1426960 0.37775      
          year.cM     0.0002854 0.01689  0.83
 Residual             0.2966298 0.54464      
Number of obs: 22081, groups:  ID, 8565

Fixed effects:
            Estimate Std. Error t value
(Intercept) 4.760368   0.005535  860.07
year.cM     0.001783   0.001230    1.45

Correlation of Fixed Effects:
        (Intr)
year.cM 0.166 </code></pre>
</div>
</div>
</section>
<section id="smushing-variance" class="slide level2">
<h2>Smushing variance</h2>
<p>Each level-1 predictor that is NOT TIME is really 2 predictor variables. It is important to separate within-person from between person variance. Failing to do so will “smush” between and within variance to level 1.</p>
</section>
<section class="slide level2">

<p>Level 1: <span class="math display">\[{Y}_{ij} = \beta_{0j}  + \beta_{1j}(X_{ij}- \bar{X_j}) + \varepsilon_{ij}\]</span></p>
<p>Level 2: <span class="math display">\[{\beta}_{0j} = \gamma_{00} + \bar{X_j} +   U_{0j}\]</span></p>
<p><span class="math display">\[{\beta}_{1j} = \gamma_{10} + \bar{X_j} + U_{1j}\]</span></p>
</section>
<section class="slide level2">

<ul>
<li><p>Time is a special level-1 variable, as time unfolds similarly for all, so we do not necessarily have to center it nor add back in the average.</p></li>
<li><p>Because time unfolds the same for everyone, there are no between people differences. Thus no need to center.</p></li>
<li><p>Sometimes we will center to reduce slope correlation with intercept. Typically we “center” to get a meaningful zero.</p></li>
</ul>
</section>
<section id="estimation" class="slide level2">
<h2>Estimation</h2>
<p>We need to identify: 1. the estimates of each parameter 2. some measure of precision of that estimate (SEs) 3. an index of overall model fit (deviance/-2LL/aic/bic)</p>
<p>We will use maximum likelihood (and variants of) as well as MCMC (Bayesian) for estimation.</p>
<p>Model comparison is usually done through a likelihood ratio test distributed as a chi square.</p>
</section>
<section id="ml-vs-reml" class="slide level2">
<h2>ML vs REML</h2>
<p>REML = Restricted maximum likelihood</p>
<p>Similar to sample vs population estimates of SD where we do or don’t divide by n-1, ML downward biases random effect estimates.</p>
<p>REML maximizes the likelihood of the residuals, so models with different fixed effects are not on the same scale and are not comparable. As a result, you cannot compare fixed models with likleihood metrics (aic) with REML. You can compare variance differences.</p>
</section>
<section id="testing-significance" class="slide level2">
<h2>Testing significance</h2>
<p>Methods for testing single parameters From worst to best:</p>
<ol type="1">
<li>Wald Z-tests. Easy to compute. However, they are asymptotic approximations, assuming both that (1) the sampling distributions of the parameters are multivariate normal and that (2) the sampling distribution of the log-likelihood is (proportional to) χ2.</li>
<li>Wald t-tests</li>
<li>Likelihood ratio test.<br>
</li>
<li>Markov chain Monte Carlo (MCMC) or parametric bootstrap confidence intervals</li>
</ol>
</section>
<section id="likelhiood-ratio-test" class="slide level2">
<h2>Likelhiood ratio test</h2>
<p>How much more likely the data is under a more complex model than under the simpler model (these models need to be nested to compare this).</p>
<p>Log Likelihood (LL) is derived from ML estimation. Larger the LL the better the fit. Deviance compares two LLs. Current model and a saturated model (that fits data perfectly).</p>
<p>Deviance = -2[LL current - LL saturated]</p>
<p>LL saturated = 1 for MLMs (probability it will perfectly recapture data). log of 1 is 0. So this term drops out.</p>
<p>Deviance = -2LL current model.</p>
</section>
<section id="likelhiood-ratio-test-1" class="slide level2">
<h2>Likelhiood ratio test</h2>
<p>Comparing 2 models is called a likelihood ration test. Need to have: 1. same data 2. nested models (think of constraining a parameter to zero)</p>
<p>Distributed as chi-square with df equal to constraint differences between models.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="fu">anova</span>(mod<span class="fl">.2</span>, mod<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Data: b5_long
Models:
mod.1: C ~ 1 + (1 | ID), zi=~0, disp=~1
mod.2: C ~ 1 + year + (1 | ID), zi=~0, disp=~1
      Df   AIC   BIC logLik deviance  Chisq Chi Df Pr(&gt;Chisq)
mod.1  3 42778 42802 -21386    42772                         
mod.2  5 42780 42820 -21385    42770 2.4256      2     0.2974</code></pre>
</div>
</div>
</section>
<section id="correlations-among-random-effects" class="slide level2">
<h2>correlations among random effects</h2>
<p><span class="math display">\[\begin{pmatrix} {U}_{0i} \\ {U}_{1i} \end{pmatrix} \sim \mathcal{N} \begin{pmatrix} 0, &amp; \tau_{00}^{2} &amp; \tau_{01}\\ 0, &amp; \tau_{01} &amp; \tau_{10}^{2} \end{pmatrix}\]</span></p>
<p>The variances and the covariation (correlations) can be of substantive interest. What do each of these terms reflect? What if one of the terms was zero, what would that mean?</p>
</section>
<section id="residual" class="slide level2">
<h2>residual</h2>
<p><span class="math display">\[ {\varepsilon}_{ti} \sim \mathcal{N}(0, \sigma^{2})  \]</span> Much like in normal regression models we often use <span class="math inline">\(\sigma^{2}\)</span> as a means to describe the fit of the model</p>
</section>
<section class="slide level2">


<img data-src="5.3.png" class="r-stretch"></section>
<section id="model-comparisons" class="slide level2">
<h2>model comparisons</h2>
<p>In setting up the basic growth model we have a series of questions to address:</p>
<ol type="1">
<li>Do we need to add a time component?</li>
<li>If so, do we need to allow that to vary across people?</li>
<li>if so, do we want to allow the intercept to correlate with the slope?</li>
</ol>
<p>Usually 1 &amp; 2 are explicitly tested whereas 3 is more theoretical</p>
</section>
<section class="slide level2">


<img data-src="5.1.png" class="r-stretch"></section>
<section id="centering-redux" class="slide level2">
<h2>centering redux</h2>
<p>The correlation among random intercept and slopes is directly related to centering of variables. The two standard choices for time is to center at the mean of time or at the start of time. Both have their pros and cons.</p>

<img data-src="5.4.png" width="550" class="r-stretch"></section>
<section id="other-types-of-models" class="slide level2">
<h2>Other types of models</h2>
<p>Depending on your DV, you might not want to have a Gaussian sampling distribution. Instead you may want something like a Poisson or a negative binomial if you are using some sort of count data. You can do this somewhat with lme4. However, the BRMS package – which uses Bayesian estimation – has many more possibilities: geometric, log normal, weibull, exponential, gamma, Beta, hurdle Poisson/gamma/negative binomial, zero inflated beta/Poisson/negative binomial, cumulative. Maybe we will fit some of these later in the semester.</p>
</section>
<section id="accelerated-longitudinal-designs" class="slide level2">
<h2>Accelerated longitudinal designs</h2>
<ul>
<li><p>Want to track the trend of a construct across the lifespan, using data that do not cover an entire lifespan (eg. made up of people who have some longitudinal data)</p></li>
<li><p>Time needs to be set as age. Cannot do time since baseline as our time metric.</p></li>
</ul>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb59-2"><a href="#cb59-2"></a></span>
<span id="cb59-3"><a href="#cb59-3"></a>n_per_cohort <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb59-4"><a href="#cb59-4"></a>time_points <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>  </span>
<span id="cb59-5"><a href="#cb59-5"></a></span>
<span id="cb59-6"><a href="#cb59-6"></a>df <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb59-7"><a href="#cb59-7"></a>  <span class="at">ID_in_Cohort =</span> <span class="dv">1</span><span class="sc">:</span>n_per_cohort,</span>
<span id="cb59-8"><a href="#cb59-8"></a>  <span class="at">Cohort_Start_Age =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>), </span>
<span id="cb59-9"><a href="#cb59-9"></a>  <span class="at">Time =</span> time_points                </span>
<span id="cb59-10"><a href="#cb59-10"></a>)</span>
<span id="cb59-11"><a href="#cb59-11"></a></span>
<span id="cb59-12"><a href="#cb59-12"></a>df<span class="sc">$</span>ID <span class="ot">&lt;-</span> <span class="fu">paste0</span>(df<span class="sc">$</span>Cohort_Start_Age, <span class="st">"_"</span>, df<span class="sc">$</span>ID_in_Cohort)</span>
<span id="cb59-13"><a href="#cb59-13"></a></span>
<span id="cb59-14"><a href="#cb59-14"></a>df<span class="sc">$</span>Outcome <span class="ot">&lt;-</span> (df<span class="sc">$</span>Cohort_Start_Age <span class="sc">*</span> <span class="fl">1.5</span>) <span class="sc">+</span> (df<span class="sc">$</span>Time <span class="sc">*</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">nrow</span>(df))</span>
<span id="cb59-15"><a href="#cb59-15"></a></span>
<span id="cb59-16"><a href="#cb59-16"></a></span>
<span id="cb59-17"><a href="#cb59-17"></a>acc.model <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Outcome <span class="sc">~</span> Time <span class="sc">*</span> Cohort_Start_Age <span class="sc">+</span> (Time <span class="sc">|</span> ID), <span class="at">data =</span> df)</span>
<span id="cb59-18"><a href="#cb59-18"></a></span>
<span id="cb59-19"><a href="#cb59-19"></a><span class="fu">summary</span>(acc.model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: Outcome ~ Time * Cohort_Start_Age + (Time | ID)
   Data: df

REML criterion at convergence: 5709.4

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.9637 -0.6664  0.0015  0.6793  3.3323 

Random effects:
 Groups   Name        Variance  Std.Dev. Corr 
 ID       (Intercept) 0.0003285 0.01812       
          Time        0.0032559 0.05706  -1.00
 Residual             0.9865883 0.99327       
Number of obs: 2000, groups:  ID, 400

Fixed effects:
                       Estimate Std. Error t value
(Intercept)           0.0677455  0.1264579   0.536
Time                  0.4879624  0.0524566   9.302
Cohort_Start_Age      1.4982899  0.0034417 435.328
Time:Cohort_Start_Age 0.0006497  0.0014277   0.455

Correlation of Fixed Effects:
            (Intr) Time   Ch_S_A
Time        -0.807              
Chrt_Strt_A -0.953  0.769       
Tm:Chrt_S_A  0.769 -0.953 -0.807
optimizer (nloptwrap) convergence code: 0 (OK)
Model failed to converge with max|grad| = 0.00468635 (tol = 0.002, component 1)
  See ?lme4::convergence and ?lme4::troubleshooting.</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a>pred_grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb61-2"><a href="#cb61-2"></a>  <span class="at">Cohort_Start_Age =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>),  </span>
<span id="cb61-3"><a href="#cb61-3"></a>  <span class="at">Time =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="at">by =</span> <span class="fl">0.5</span>)         </span>
<span id="cb61-4"><a href="#cb61-4"></a>)</span>
<span id="cb61-5"><a href="#cb61-5"></a></span>
<span id="cb61-6"><a href="#cb61-6"></a>pred_grid<span class="sc">$</span>Chronological_Age <span class="ot">&lt;-</span> pred_grid<span class="sc">$</span>Cohort_Start_Age <span class="sc">+</span> pred_grid<span class="sc">$</span>Time</span>
<span id="cb61-7"><a href="#cb61-7"></a></span>
<span id="cb61-8"><a href="#cb61-8"></a></span>
<span id="cb61-9"><a href="#cb61-9"></a>pred_grid<span class="sc">$</span>Predicted_Outcome <span class="ot">&lt;-</span> <span class="fu">predict</span>(acc.model, <span class="at">newdata =</span> pred_grid, <span class="at">re.form =</span> <span class="cn">NA</span>)</span>
<span id="cb61-10"><a href="#cb61-10"></a></span>
<span id="cb61-11"><a href="#cb61-11"></a><span class="fu">ggplot</span>(pred_grid, <span class="fu">aes</span>(<span class="at">x =</span> Chronological_Age, </span>
<span id="cb61-12"><a href="#cb61-12"></a>                      <span class="at">y =</span> Predicted_Outcome, </span>
<span id="cb61-13"><a href="#cb61-13"></a>                      <span class="at">group =</span> <span class="fu">factor</span>(Cohort_Start_Age), </span>
<span id="cb61-14"><a href="#cb61-14"></a>                      <span class="at">color =</span> <span class="fu">factor</span>(Cohort_Start_Age))) <span class="sc">+</span></span>
<span id="cb61-15"><a href="#cb61-15"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb61-16"><a href="#cb61-16"></a>  <span class="fu">stat_smooth</span>(<span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>), <span class="at">method =</span> <span class="st">"lm"</span>, </span>
<span id="cb61-17"><a href="#cb61-17"></a>              <span class="at">color =</span> <span class="st">"grey"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb61-18"><a href="#cb61-18"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cohort-Sequential Plot"</span>,</span>
<span id="cb61-19"><a href="#cb61-19"></a>       <span class="at">x =</span> <span class="st">"Chronological Age"</span>,</span>
<span id="cb61-20"><a href="#cb61-20"></a>       <span class="at">y =</span> <span class="st">"Outcome Score"</span>,</span>
<span id="cb61-21"><a href="#cb61-21"></a>       <span class="at">color =</span> <span class="st">"Cohort (Start Age)"</span>) <span class="sc">+</span></span>
<span id="cb61-22"><a href="#cb61-22"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb61-23"><a href="#cb61-23"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="mlm-2_files/figure-revealjs/unnamed-chunk-44-1.png" width="960" class="r-stretch"></section>
<section id="fixed-effects" class="slide level2">
<h2>Fixed effects</h2>
<p>Other fields model dependencies differently. Econometrics for example often uses “fixed effects” for panel studies where you add Person ID as a categorical predictor rather than account for dependencies via random effects.</p>
<p>While it adequately controls for person dependencies it does not allow prediction of why individual differences occurred</p>
</section>
<section id="multiple-level-1-predictors" class="slide level2">
<h2>Multiple level 1 predictors</h2>
<p>Level 1:</p>
<p><span class="math display">\[{Y}_{ti} = \beta_{0i}  + \beta_{1i}time_{ti} + \beta_{2i}Z_{ti} + \varepsilon_{ti}\]</span> Level 2: <span class="math display">\[{\beta}_{0i} = \gamma_{00} + U_{0i}\]</span></p>
<p><span class="math display">\[{\beta}_{1i} = \gamma_{10} + U_{1i}\]</span> <span class="math display">\[{\beta}_{2i} = \gamma_{20} + U_{2i}\]</span></p>
</section>
<section class="slide level2">

<ul>
<li><p>Remember that MLM is just like a lot of separate regressions done at Level 1.</p></li>
<li><p>What happens when we have multiple predictors? The effect of any one variable partials out the common variance, the same as with multiple regression.</p></li>
</ul>
</section>
<section id="level-2-predictors" class="slide level2">
<h2>Level 2 predictors</h2>
<p>Level 1: <span class="math display">\[{Y}_{ti} = \beta_{0i}  + \beta_{1j}time_{ti} + \varepsilon_{ti}\]</span></p>
<p>Level 2: <span class="math display">\[{\beta}_{0i} = \gamma_{00} + \gamma_{01}G_{i} +   U_{0i}\]</span></p>
<p><span class="math display">\[{\beta}_{1i} = \gamma_{10} + U_{1i}\]</span></p>
</section>
<section class="slide level2">

<p>Combined <span class="math display">\[{Y}_{ti} = \gamma_{00} + \gamma_{01}G_{i}+  \gamma_{10} Time_{ti} + U_{0i} + U_{1j}Time_{ti} + \varepsilon_{ti}\]</span></p>
<p><span class="math display">\[{Y}_{ti} = [\gamma_{00} + \gamma_{01}G_{i}+ U_{0i}]  + [(\gamma_{10}  + U_{1i})(Time_{ti})] + \varepsilon_{ti}\]</span></p>
</section>
<section class="slide level2">

<ul>
<li><p>Level 2 refers to Between-Person (BP) Variation, INTER-individual, Differences, Time-Invariant, make comparisons across individuals.</p></li>
<li><p>Some variables can be both depending on how you measure them. E.g. Age</p></li>
<li><p>Level 1 and Level 2 can be differentiated in your dataset by which one repeats vs which is consistent.</p></li>
</ul>
</section>
<section id="cross-level-interactions" class="slide level2">
<h2>Cross level interactions</h2>
<p>level 1: <span class="math display">\[{Y}_{ti} = \beta_{0i}  + \beta_{1i}time_{ti} + \varepsilon_{ti}\]</span> Level 2: <span class="math display">\[{\beta}_{0i} = \gamma_{00} + \gamma_{01}G_{i} +   U_{0i}\]</span></p>
<p><span class="math display">\[{\beta}_{1i} = \gamma_{10} + \gamma_{11}G_{i} + U_{1i}\]</span></p>
<p><span class="math display">\[{Y}_{ti} = \gamma_{00} + \gamma_{01}G_{i}+  \gamma_{10} (time_{ti}) + \gamma_{11}(G_{i}*time_{ti}) +  U_{0j} + U_{1i}(time_{ti}) + \varepsilon_{ti}\]</span></p>
<p><span class="math display">\[{Y}_{ti} = [\gamma_{00} + U_{0i} +\gamma_{01}G_{i}] + [(\gamma_{10}  + \gamma_{11}G_{i}+  U_{1i})(time_{ti})] + \varepsilon_{ti}\]</span></p>

<div class="footer footer-default">

</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>